{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>Ministore</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Стили -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- Скрипты -->
    <script src="{% static 'js/modernizr.js' %}"></script>

                    <style>
        body, html {
          margin: 0;
          padding: 0;
          height: 100%;
        }

        .section-container {
          min-height: 90vh; /* займёт почти весь экран */
          padding-top: 130px;
          padding-bottom: 60px;
          background-color: #f9f9f9;
          display: flex;
          flex-direction: column;
        }

        .section-title {
          text-align: center;
          font-weight: 600;
          margin-bottom: 40px;
          font-size: 2.4rem;
          color: #222;
        }

        .grid {
          flex: 1;
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
          gap: 30px;
          padding: 0 40px;
          width: 100%;
        }

        .card {
          background-color: #fff;
          border-radius: 16px;
          box-shadow: 0 8px 20px rgba(0,0,0,0.1);
          overflow: hidden;
          transition: all 0.3s ease;
        }

        .card:hover {
          transform: translateY(-5px);
          box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }

              .card img {
        width: 100%;
        height: 300px; 
        object-fit: cover;
        border-bottom: 1px solid #ddd;
      }

      .card h2 {
        padding: 1rem;
        font-size: 1.3rem;
        color: #333;
      }

        @media (max-width: 768px) {
          .grid {
            padding: 0 20px;
          }

          .card img {
            height: 220px;
          }
        }
      </style>

    <!-- Скрипты -->
    <script src="{% static 'js/modernizr.js' %}"></script>
</head>

    
    <header id="header" class="site-header header-scrolled position-fixed text-black bg-light">
      <nav id="header-nav" class="navbar navbar-expand-lg px-3 mb-3">
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html">
            <img src="{% static 'images/main-logo.png' %}" class="logo">
          </a>
          <button class="navbar-toggler d-flex d-lg-none order-3 p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#bdNavbar" aria-controls="bdNavbar" aria-expanded="false" aria-label="Toggle navigation">
            <svg class="navbar-icon">
              <use xlink:href="#navbar-icon"></use>
            </svg>
          </button>
          <div class="offcanvas offcanvas-end" tabindex="-1" id="bdNavbar" aria-labelledby="bdNavbarOffcanvasLabel">
            <div class="offcanvas-header px-4 pb-0">
              <a class="navbar-brand" href="index.html">
                <img src="{% static 'images/main-logo.png' %}" class="logo">
              </a>
              <button type="button" class="btn-close btn-close-black" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#bdNavbar"></button>
            </div>
            <div class="offcanvas-body">
              <ul id="navbar" class="navbar-nav text-uppercase justify-content-end align-items-center flex-grow-1 pe-3">
                <li class="nav-item">
                  <a class="nav-link me-4 active" href={% url  'main:index' %}>Домой</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link me-4" href="#company-services">Услуги</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link me-4" href="#mobile-products">Продукты</a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link me-4 dropdown-toggle link-dark" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Страницы</a>
                  <ul class="dropdown-menu">
                    <li>
                      <a href="about.html" class="dropdown-item">О нас</a>
                    </li>
                    <li>
                      <a href={% url 'Catalog:list_product'%}  class="dropdown-item">Магазин</a>
                    </li>
                    <li>
                      <a href="cart.html" class="dropdown-item">Корзина</a>
                    </li>
                    <li>
                      <a href="contact.html" class="dropdown-item">Контакты</a>
                    </li>
                  </ul>
                </li>
                {% if user.is_authenticated %}
                <li class="nav-item">
                  <a class="nav-link" href={% url  'main:index' %}>{{user.name}} {{user.fullname}}</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href={% url  'Users:logout' %}>Выйти</a>
                </li>
                {% endif%}
                <li class="nav-item">
                  <div class="user-items ps-5">
                    <ul class="d-flex justify-content-end list-unstyled">
                      <li class="search-item pe-3">
                        <a href="#" class="search-button">
                          <svg class="search">
                            <use xlink:href="#search"></use>
                          </svg>
                        </a>
                      </li>
                      {% if  user.is_authenticated == False%}
                      <li class="pe-3">
                        <a href="{% url  'Users:login' %}">
                          <svg class="user">
                            <use xlink:href="#user"></use>
                          </svg>
                        </a>
                      </li>
                      {% endif %}
                      <li>
                        <a href="cart.html">
                          <svg class="cart">
                            <use xlink:href="#cart"></use>
                          </svg>
                        </a>
                      </li>
                    </ul>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </nav>
    </header>


<main style = "padding-top: 100px;">
  
    </div>
    <div class="container">
    <div class="row">

        <!-- Фильтры слева -->
        <aside class="col-md-3 mb-4">
            <h5>Категории</h5>
            
            <ul class="list-group">
                {% for category in categories %}
                <li class="list-group-item">
                    <a href="?step={{ category }}">{{ category }}</a>
                </li>
                {% endfor %}
            </ul>

            <h5 class="mt-4">Фильтры</h5>
            <form method="get" action="">
                <div class="mb-3">
                    <label for="order" class="form-label">Сортировка</label>
                    <select id="order" name="order" class="form-select">
                        <option value="1" {% if request.GET.order == '1' %}selected{% endif %}>По цене ↑</option>
                        <option value="2" {% if request.GET.order == '2' %}selected{% endif %}>По цене ↓</option>
                    </select>
                </div>

                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="stock" name="stock" value="now-today" {% if 'now-today' in request.GET.stock %}checked{% endif %}>
                    <label class="form-check-label" for="stock">В наличии</label>
                </div>
                <button type="submit" class="btn btn-primary btn-sm">Применить</button>
            </form>
        </aside>    
        <form method = "post" action= "">
            {%csrf_token%}
                <div class="container d-flex justify-content-between align-items-center">
                    <input class="form-control me-2" type="search" placeholder="Поиск" aria-label="Search" name="q" value="{{ request.GET.q }}">
                    <button class="btn btn-outline-primary" type="submit">Найти</button>
                </div>
        </form>

        <!-- Основной контент с товарами -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="h5">Результаты поиска: "{{ page }}"</h2>
                <span>{{ products|length }} товаров</span>
            </div>

            <div class="row g-3">
               {% if products %}
                    {% for product in products %}
                        <div class="col-6 col-md-4 col-lg-3">
                            <div class="card h-100">
                                {% for img in product.images.all %}
                                    {% if img.cover  == True%}
                                        <img src="{{ img.image.url }}" class="card-img-top" alt="{{ product.name }}">
                                    {% endif %}
                                {% endfor %}
                                <div class="card-body d-flex flex-column">
                                    <h6 class="card-title">{{ product.name }}</h6>
                                    <p class="card-text text-danger fw-bold mb-2">{{ product.price }} ₽</p>
                                    <a href="№" class="btn btn-outline-primary mt-auto btn-sm">Подробнее</a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>Товары не найдены.</p>
                {% endif %}
            </div>
        
    </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
<footer id="footer" class="overflow-hidden">
    <div class="container">
        <div class="row">
          <div class="footer-top-area">
            <div class="row d-flex flex-wrap justify-content-between">
              <div class="col-lg-3 col-sm-6 pb-3">
                <div class="footer-menu">
                  <img src="{% static 'images/main-logo.png' %}" alt="logo">
                  <p>Компактный магазин, максимум возможностей!</p>
                </div>
              </div>
              <div class="col-lg-2 col-sm-6 pb-3">
                <div class="footer-menu text-uppercase">
                  <h5 class="widget-title pb-2">Быстрые ссылки</h5>
                  <ul class="menu-list list-unstyled text-uppercase">
                    <li class="menu-item pb-2">
                      <a href="#">Домой</a>
                    </li>
                    <li class="menu-item pb-2">
                      <a href="#">О нас</a>
                    </li>
                    <li class="menu-item pb-2">
                      <a href="#">Каталог</a>
                    </li>
                    <li class="menu-item pb-2">
                      <a href="#">Contact</a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-3 col-sm-6 pb-3">
                <div class="footer-menu text-uppercase">
                  <h5 class="widget-title pb-2">Help & Info Help</h5>
                  <ul class="menu-list list-unstyled">
                    <li class="menu-item pb-2">
                      <a href="#">Отслеживать Ваш заказ</a>
                    </li>
                    <li class="menu-item pb-2">
                      <a href="#">Политика возврата товаров</a>
                    </li>
                    <li class="menu-item pb-2">
                      <a href="#">Доставка + самовывоз</a>
                    </li>
                    <li class="menu-item pb-2">
                      <a href="#">Связаться с нами</a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-3 col-sm-6 pb-3">
                <div class="footer-menu contact-item">
                  <h5 class="widget-title text-uppercase pb-2">Связаться с нами</h5>
                  <p>У вас есть какие-либо вопросы или предложения?<a href="mailto:">#</a>
                  </p>
                  <p>Если вам нужна поддержка? Просто позвоните нам.<a href="">#</a>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <hr>
  </footer>

  <!-- Скрипты -->
  <script src="{% static 'js/jquery-1.11.0.min.js' %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
  <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'js/plugins.js' %}"></script>
  <script src="{% static 'js/script.js' %}"></script>
</body>
</html>
